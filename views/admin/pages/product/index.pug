extends ../../layouts/default
include ../../mixins/filter-status
include ../../mixins/search
include ../../mixins/pagination
include ../../mixins/form-change-multi
include ../../mixins/alert
include ../../mixins/form-sort-multi

block main 

    +alert-success("5000")
    +alert-error("5000")

    if(user.role.permissions.includes("product_view"))            
        //- Filter & Search
        .card.mb-3 
            h5.card-header Filters &amp; Search
            .card-body
                .row.align-items-center
                    .col-6
                        +filterStatus(filterStatus)
                    .col-6
                        +search(keyword)
        //- End Filter & Search

        //- Table product list
        .card
            //- Change status multi product
            .row.m-0.p-sm-4.p-2
                .col-md-5.col-4.p-0
                    div
                        +form-sort-multi()
                    //- End Sort
                if(user.role.permissions.includes("product_edit"))
                    .col-5.p-0
                        div
                            +form-change-multi(`${prefixAdmin}/products/change-multi?_method=PATCH`)
                if(user.role.permissions.includes("product_create"))
                    .col-md-2.col-3.p-0.text-end
                        a.btn.btn-primary.text-white.p-sm-8(
                            type='button'
                            href=`${prefixAdmin}/products/create`
                        )
                            span.tf-icons.bx.bx-message-alt-add.d-inline.me-1.p-0
                            span Add
            //- End Change status multi product
            .table-responsive.text-nowrap
                table.table
                    thead
                        tr
                            if(user.role.permissions.includes("product_edit"))
                                th 
                                    input(type="checkbox" name="check-box-all")
                            th NO.
                            th IMAGE
                            th TITLE
                            th PRICE
                            th POSITION
                            th STATUS
                            th ACTIONS
                    tbody.table-border-bottom-0
                        each item, index in products
                            tr
                                if(user.role.permissions.includes("product_edit"))
                                    td 
                                        input(type="checkbox" name="check-box-item" idItem=`${item.id}`)
                                td
                                    i.fab.fa-angular.fa-lg.text-danger.me-3
                                    strong #{pagination.limit*(pagination.currentPage - 1) + index + 1}
                                td 
                                    img(
                                        src=item.thumbnail
                                        alt=item.title
                                        width="60px"
                                        height="auto"
                                    )
                                td 
                                    a.text-dark(href=`${prefixAdmin}/products/detail/${item.id}`) #{item.title}
                                td #{item.price}
                                td 
                                    input(
                                        type="number"
                                        value=item.position 
                                        style="width: 60px; text-align: center; border-radius: 10px"
                                        min="1"
                                        name="position"
                                    )
                                td
                                    if(user.role.permissions.includes("product_edit"))
                                        if(item.status=="active")
                                            span(
                                                class="badge bg-label-primary me-1 cursor-pointer" 
                                                button-change-status
                                                statusCurrent=item.status
                                                idItem=item.id
                                            ) Active
                                        else 
                                            span(
                                                class="badge bg-label-warning me-1 cursor-pointer"
                                                button-change-status
                                                statusCurrent=item.status
                                                idItem=item.id
                                            ) Pending
                                    else 
                                        if(item.status=="active")
                                            span(
                                                class="badge bg-label-primary me-1" 
                                            ) Active
                                        else 
                                            span(
                                                class="badge bg-label-warning me-1"
                                            ) Pending
                                td
                                    .dropdown
                                        button.btn.p-0.dropdown-toggle.hide-arrow(type='button' data-bs-toggle='dropdown')
                                            i.bx.bx-dots-vertical-rounded
                                        .dropdown-menu
                                            if(user.role.permissions.includes("product_edit"))
                                                a(
                                                    class="dropdown-item cursor-pointer "
                                                    href=`${prefixAdmin}/products/edit/${item.id}`
                                                )
                                                    i.bx.bx-edit-alt.me-1
                                                    |  Edit
                                            if(user.role.permissions.includes("product_delete"))
                                                button(
                                                    class="dropdown-item"
                                                    button-delete
                                                    idItem=`${item.id}`
                                                )
                                                    i.bx.bx-trash.me-1
                                                    |  Delete
        //- End Table product list

        //- Basic Pagination
        +pagination(pagination)
        //- End Basic Pagination

        //- Form change status
        form(
            action
            method="POST"
            id="form-change-status"
            path=`${prefixAdmin}/products/change-status`
        )
        //- End Form change status

        //- Form delete product
        form(
            action
            method="POST"
            id="form-delete"
            path=`${prefixAdmin}/products/delete`
        )
        //- End Form delete product
    
    else 
        h2 You do not have permission to access this page.

    